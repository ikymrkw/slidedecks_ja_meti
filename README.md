# ja_meti

Convert indices of Research Reports (in Japanese) to a CSV.  The reports are written by consignee companies/organizations, and published by METI, a ministry in Japan gov, at https://www.meti.go.jp/topic/data/e90622aj.html.

	
## Downloading indices to a CSV file
```shell
python mklist_resrep.py
```

This will download Excel files from the website,
and sort them out to a single index, and save it to the file `resrep.csv`.
A sample output is in [resrep_FY2019-2023.csv](resrep_FY2019-2023.csv), containing 2,788 entries.

Note that the current script only reads Excel-format indices during FY2019-FY2023.
If you want to read those from FY2024 and later, you need to make small changes to the script.
The script is not compatible with FY2018 and before, because it only supports Reiwa (令和; on and after 2019) as Gengo (元号) year format.

	
## CSV format

You can easily read the CSV file by `pandas.read_csv()`.
Note that the first line is for column names.
The columns `title`, `consignee`, and `consignor` mostly consist of Japanese characters encoded in UTF-8.	

Columns are:
| Column       | Original column | Sample | Note |
|--------------|-----------------|--------|------|
|`id`          |管理番号 | `FY2019_000397` | *1 |
|`released_on` |掲載日 | `20240907` | *2 |
|`file_code`   |ファイル\nコード | | should be ignored |
|`title`       |委　託　調　査　報　告　書　名|令和元年... | |
|`consignee`   |委託事業者名 | 株式会社... | |
|`consignor`   |担当室課名 | 資源エネルギー庁::資源・燃料部政策課 | *3 |
|`size_mb`     |PDF・ZIP\n容量\n（ＭＢ） | 5.3 | should be ignored |
|`document_url`|ＨＰアドレス（報告書）| http://....pdf | *4 |
|`data_url`    |ＨＰアドレス（データ）| | *4; should be ignored |

- *1: For `id`, the fiscal year (`FY####_`) is prepended. Optionally, suffix number (like `_1`) is appended when the (original) number is duplicated. ("Cont'd" rows are not regarded as duplicated; see *4 below.)
- *2: For `released_on`, the years are in western style (like `2024mmdd`), converted from the original Japanese Gengo style year format.
- *3: For `consignor`, any newline character `\n` in the string is converted to `::`. This can be used as a separator for organizational hierarchy (though it is not guaranteed to be so in all the cases).
- *4: For `document_url` and `data_url`, a cell in these columns may contain **a comma-separated list of URLs**, having multiple URLs in rare occasions. This is because, in original Excel index, there are lines with title "（続き）" (which means "(Cont'd)"), each of which gives an additional URL for its preceding line. Multiple "Cont'd" lines for one entry are possible. The script compresses these multiple lines into a single row (or entry) by appending additional URL(s) in comma-separated list format.

	
## Word cloud

The word cloud from `consignee`:
![consignee](wordclouds/wc_consignee.png)

The word cloud from `consignor`, 1st part (before `::`) only:
![consignor_1st](wordclouds/wc_consignor_1st.png)

The word cloud from `consignor`, full part:
![consignor](wordclouds/wc_consignor.png)

The word cloud from `title`, extracted nouns only, excluding ("令和", "年度", "経済", "産業", "事業"):
![title_nouns](wordclouds/wc_title_nouns_excluded.png)

These word clouds are generated by wcloud.py (with a help of wordcloud package). If you want to run it by yourself, you may need to install ipaexfont-gothic and also to adjust variables in the script to make different word clouds.


## Subset analysis

To grasp subset sizes of some facets, I made the script `subset.py`. Its output is in [subset_out.txt](subset_out.txt).
